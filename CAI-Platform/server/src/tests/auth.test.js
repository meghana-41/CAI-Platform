Unit tests for authentication logic.